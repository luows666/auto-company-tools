<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä»Šæ—¥è¿åŠ¿ç”Ÿæˆå™¨ - å¹¸è¿å¡ç‰‡</title>
    <meta name="description" content="ç”Ÿæˆä½ çš„ä»Šæ—¥è¿åŠ¿å¡ç‰‡ï¼Œä¸€é”®ä¿å­˜å›¾ç‰‡åˆ†äº«åˆ°æœ‹å‹åœˆ">
    <meta name="keywords" content="ä»Šæ—¥è¿åŠ¿,å¹¸è¿å¡ç‰‡,æ˜Ÿåº§,å åœ,åˆ†äº«">
    <style>
        :root {
            --primary: #f59e0b;
            --primary-dark: #d97706;
            --bg: #fffbeb;
            --card: #ffffff;
            --text: #1f2937;
            --text-light: #6b7280;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--bg);
            color: var(--text);
            min-height: 100vh;
            padding: 20px;
        }

        h1 {
            text-align: center;
            margin-bottom: 8px;
            color: var(--primary);
        }

        .subtitle {
            text-align: center;
            color: var(--text-light);
            font-size: 0.875rem;
            margin-bottom: 20px;
        }

        .container {
            max-width: 500px;
            margin: 0 auto;
        }

        .card {
            background: var(--card);
            border-radius: 16px;
            padding: 20px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            margin-bottom: 16px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
        }

        input, select {
            width: 100%;
            padding: 12px;
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            font-size: 1rem;
            margin-bottom: 16px;
            font-family: inherit;
        }

        input:focus, select:focus {
            outline: none;
            border-color: var(--primary);
        }

        .zodiac-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 8px;
            margin-bottom: 16px;
        }

        .zodiac-btn {
            padding: 10px 4px;
            border: 2px solid #e5e7eb;
            background: white;
            border-radius: 8px;
            cursor: pointer;
            text-align: center;
            font-size: 0.75rem;
            transition: all 0.2s;
        }

        .zodiac-btn:hover {
            border-color: var(--primary);
        }

        .zodiac-btn.active {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }

        .generate-btn {
            width: 100%;
            padding: 16px;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 1.125rem;
            font-weight: 600;
            cursor: pointer;
            transition: background 0.2s;
            margin-bottom: 16px;
        }

        .generate-btn:hover {
            background: var(--primary-dark);
        }

        .fortune-display {
            display: none;
            text-align: center;
        }

        .fortune-display.show {
            display: block;
        }

        #fortuneCanvas {
            width: 100%;
            border-radius: 12px;
            margin-bottom: 16px;
        }

        .action-btns {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
        }

        .action-btn {
            padding: 12px;
            border: none;
            border-radius: 8px;
            font-size: 0.875rem;
            font-weight: 500;
            cursor: pointer;
            transition: opacity 0.2s;
        }

        .action-btn:hover {
            opacity: 0.9;
        }

        .download-btn {
            background: #10b981;
            color: white;
        }

        .copy-btn {
            background: #3b82f6;
            color: white;
        }

        .tips {
            background: #fef3c7;
            border-radius: 8px;
            padding: 12px;
            margin-top: 16px;
            font-size: 0.875rem;
            color: #92400e;
        }

        .tips strong {
            display: block;
            margin-bottom: 4px;
        }

        .back-link {
            display: inline-block;
            margin-top: 20px;
            color: var(--primary);
            text-decoration: none;
            font-size: 0.875rem;
        }

        .back-link:hover {
            text-decoration: underline;
        }

        .lucky-numbers {
            display: flex;
            justify-content: center;
            gap: 8px;
            margin-top: 12px;
            flex-wrap: wrap;
        }

        .lucky-num {
            width: 32px;
            height: 32px;
            background: linear-gradient(135deg, #f59e0b, #fbbf24);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 0.875rem;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ä»Šæ—¥è¿åŠ¿ç”Ÿæˆå™¨</h1>
        <p class="subtitle">ç”Ÿæˆä½ çš„ä¸“å±è¿åŠ¿å¡ç‰‡ï¼Œåˆ†äº«åˆ°æœ‹å‹åœˆ</p>

        <div class="card">
            <label>é€‰æ‹©ä½ çš„æ˜Ÿåº§</label>
            <div class="zodiac-grid" id="zodiacGrid">
                <div class="zodiac-btn" data-zodiac="ç™½ç¾Šåº§">ç™½ç¾Šâ™ˆ</div>
                <div class="zodiac-btn" data-zodiac="é‡‘ç‰›åº§">é‡‘ç‰›â™‰</div>
                <div class="zodiac-btn" data-zodiac="åŒå­åº§">åŒå­â™Š</div>
                <div class="zodiac-btn" data-zodiac="å·¨èŸ¹åº§">å·¨èŸ¹â™‹</div>
                <div class="zodiac-btn" data-zodiac="ç‹®å­åº§">ç‹®å­â™Œ</div>
                <div class="zodiac-btn" data-zodiac="å¤„å¥³åº§">å¤„å¥³â™</div>
                <div class="zodiac-btn" data-zodiac="å¤©ç§¤åº§">å¤©ç§¤â™</div>
                <div class="zodiac-btn" data-zodiac="å¤©èåº§">å¤©èâ™</div>
                <div class="zodiac-btn" data-zodiac="å°„æ‰‹åº§">å°„æ‰‹â™</div>
                <div class="zodiac-btn" data-zodiac="æ‘©ç¾¯åº§">æ‘©ç¾¯â™‘</div>
                <div class="zodiac-btn" data-zodiac="æ°´ç“¶åº§">æ°´ç“¶â™’</div>
                <div class="zodiac-btn" data-zodiac="åŒé±¼åº§">åŒé±¼â™“</div>
            </div>

            <label for="nickname">ä½ çš„æ˜µç§°ï¼ˆå¯é€‰ï¼‰</label>
            <input type="text" id="nickname" placeholder="æ˜¾ç¤ºåœ¨å¡ç‰‡ä¸Š" maxlength="20">

            <button class="generate-btn" onclick="generateFortune()">ç”Ÿæˆä»Šæ—¥è¿åŠ¿</button>
        </div>

        <div class="card fortune-display" id="fortuneDisplay">
            <canvas id="fortuneCanvas" width="600" height="800"></canvas>
            <div class="action-btns">
                <button class="action-btn download-btn" onclick="downloadCard()">ä¸‹è½½å›¾ç‰‡</button>
                <button class="action-btn copy-btn" onclick="copyToClipboard()">å¤åˆ¶å›¾ç‰‡</button>
            </div>
        </div>

        <div class="tips">
            <strong>å°è´´å£«</strong>
            ç‚¹å‡»ã€Œç”Ÿæˆä»Šæ—¥è¿åŠ¿ã€è·å–ä½ çš„ä¸“å±è¿åŠ¿ï¼ŒåŒ…å«å¹¸è¿æ•°å­—ã€è¿åŠ¿è§£è¯»ç­‰å†…å®¹ç”Ÿæˆåå¯ä»¥ä¸‹è½½æˆ–å¤åˆ¶åˆ†äº«åˆ°æœ‹å‹åœˆ
        </div>

        <a href="index.html" class="back-link">â† è¿”å›å·¥å…·ç®±</a>
    </div>

    <script>
        const zodiacEmojis = {
            'ç™½ç¾Šåº§': 'â™ˆ', 'é‡‘ç‰›åº§': 'â™‰', 'åŒå­åº§': 'â™Š', 'å·¨èŸ¹åº§': 'â™‹',
            'ç‹®å­åº§': 'â™Œ', 'å¤„å¥³åº§': 'â™', 'å¤©ç§¤åº§': 'â™', 'å¤©èåº§': 'â™',
            'å°„æ‰‹åº§': 'â™', 'æ‘©ç¾¯åº§': 'â™‘', 'æ°´ç“¶åº§': 'â™’', 'åŒé±¼åº§': 'â™“'
        };

        const fortunes = [
            { emoji: 'ğŸŒŸ', text: 'ä»Šå¤©ä¼šæœ‰æ„æƒ³ä¸åˆ°çš„å¥½è¿é™ä¸´åœ¨ä½ èº«è¾¹ï¼ä¿æŒå¼€æ”¾çš„å¿ƒæ€ï¼Œæ¥å—è¿™ä»½æƒŠå–œå§ã€‚', rating: 95 },
            { emoji: 'ğŸ’ª', text: 'ä½ çš„åŠªåŠ›å³å°†å¾—åˆ°å›æŠ¥ï¼Œä»Šå¤©æ˜¯æ”¶è·çš„ä¸€å¤©ï¼åšæŒä¸‹å»ï¼Œèƒœåˆ©å°±åœ¨å‰æ–¹ã€‚', rating: 90 },
            { emoji: 'ğŸ’¡', text: 'çµæ„Ÿå’Œåˆ›æ„ä»Šå¤©ä¼šç‰¹åˆ«ä¸°å¯Œï¼ŒæŠ“ä½æœºä¼šï¼Œä½ çš„æƒ³æ³•å¯èƒ½ä¼šæ”¹å˜ä¸€åˆ‡ï¼', rating: 88 },
            { emoji: 'â¤ï¸', text: 'çˆ±æƒ…è¿åŠ¿æ—ºç››ï¼Œå•èº«çš„ä½ å¯èƒ½ä¼šæœ‰æ„å¤–é‚‚é€…ï¼Œå·²æœ‰ä¼´ä¾£çš„æ„Ÿæƒ…å‡æ¸©ã€‚', rating: 85 },
            { emoji: 'ğŸ’°', text: 'è´¢è¿ä¸é”™ï¼Œé€‚åˆè¿›è¡Œç†è´¢è§„åˆ’æˆ–æŠ•èµ„å†³ç­–ã€‚ä½†è¦è°¨æ…ï¼Œä¸è¦å†²åŠ¨è¡Œäº‹ã€‚', rating: 82 },
            { emoji: 'ğŸ¯', text: 'ç›®æ ‡æ˜ç¡®ï¼Œæ•ˆç‡è¶…é«˜çš„ä¸€å¤©ï¼å®Œæˆé‡è¦ä»»åŠ¡çš„å¥½æ—¶æœºã€‚', rating: 80 },
            { emoji: 'ğŸ¤', text: 'äººé™…å…³ç³»å’Œè°ï¼Œé€‚åˆå›¢é˜Ÿåˆä½œã€‚ä¸ä»–äººå»ºç«‹è”ç³»ä¼šæœ‰æ„æƒ³ä¸åˆ°çš„æ”¶è·ã€‚', rating: 78 },
            { emoji: 'ğŸ“š', text: 'å­¦ä¹ è¿ä¸é”™ï¼Œä»Šå¤©å­¦åˆ°çš„çŸ¥è¯†å¯èƒ½ä¼šåœ¨å°†æ¥æ´¾ä¸Šç”¨åœºã€‚', rating: 75 },
            { emoji: 'ğŸƒ', text: 'è¡ŒåŠ¨åŠ›åè¶³ï¼Œä½†è¦æ³¨æ„èŠ‚å¥ã€‚åŠ³é€¸ç»“åˆæ‰èƒ½ä¿æŒæœ€ä½³çŠ¶æ€ã€‚', rating: 72 },
            { emoji: 'ğŸŒˆ', text: 'è™½ç„¶ä»Šå¤©æœ‰ç‚¹å°æ³¢æŠ˜ï¼Œä½†è¿™éƒ½æ˜¯æˆé•¿çš„å¿…ç»ä¹‹è·¯ã€‚ä¿æŒä¹è§‚ï¼Œé›¨åå½©è™¹ä¼šæ›´ç¾ã€‚', rating: 70 }
        ];

        const luckyColors = ['#FF6B6B', '#4ECDC4', '#45B7D1', '#96CEB4', '#FFEAA7', '#DDA0DD', '#98D8C8', '#F7DC6F'];
        const luckyDirections = ['ä¸œ', 'å—', 'è¥¿', 'åŒ—', 'ä¸œå—', 'ä¸œåŒ—', 'è¥¿å—', 'è¥¿åŒ—'];
        const luckyFoods = ['ç«é”…', 'çƒ§çƒ¤', 'æ—¥æ–™', 'å·èœ', 'ç²¤èœ', 'æ³°å›½èœ', 'æŠ«è¨', 'æ±‰å ¡', 'æ²™æ‹‰', 'é¥ºå­'];

        let currentFortune = null;
        let selectedZodiac = null;

        // é€‰æ‹©æ˜Ÿåº§
        document.querySelectorAll('.zodiac-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                document.querySelectorAll('.zodiac-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                selectedZodiac = btn.dataset.zodiac;
            });
        });

        function getRandomItem(arr) {
            return arr[Math.floor(Math.random() * arr.length)];
        }

        function generateLuckyNumbers() {
            const nums = [];
            while(nums.length < 6) {
                const num = Math.floor(Math.random() * 49) + 1;
                if(!nums.includes(num)) nums.push(num);
            }
            return nums.sort((a, b) => a - b);
        }

        function generateFortune() {
            if (!selectedZodiac) {
                alert('è¯·å…ˆé€‰æ‹©ä¸€ä¸ªæ˜Ÿåº§ï¼');
                return;
            }

            const nickname = document.getElementById('nickname').value || 'å°ä¼™ä¼´';
            const fortune = getRandomItem(fortunes);
            const luckyNum = generateLuckyNumbers();
            const color = getRandomItem(luckyColors);
            const direction = getRandomItem(luckyDirections);
            const food = getRandomItem(luckyFoods);

            currentFortune = {
                zodiac: selectedZodiac,
                emoji: zodiacEmojis[selectedZodiac],
                nickname,
                fortune,
                luckyNum,
                color,
                direction,
                food,
                date: new Date().toLocaleDateString('zh-CN', { year: 'numeric', month: 'long', day: 'numeric' })
            };

            drawFortuneCard();
            document.getElementById('fortuneDisplay').classList.add('show');
        }

        function drawFortuneCard() {
            const canvas = document.getElementById('fortuneCanvas');
            const ctx = canvas.getContext('2d');

            // æ¸å˜èƒŒæ™¯
            const gradient = ctx.createLinearGradient(0, 0, 600, 800);
            gradient.addColorStop(0, currentFortune.color);
            gradient.addColorStop(1, shadeColor(currentFortune.color, -30));
            ctx.fillStyle = gradient;
            ctx.fillRect(0, 0, 600, 800);

            // è£…é¥°åœ†åœˆ
            ctx.fillStyle = 'rgba(255,255,255,0.1)';
            ctx.beginPath();
            ctx.arc(100, 100, 150, 0, Math.PI * 2);
            ctx.fill();
            ctx.beginPath();
            ctx.arc(500, 700, 200, 0, Math.PI * 2);
            ctx.fill();

            // æ ‡é¢˜
            ctx.fillStyle = '#ffffff';
            ctx.font = 'bold 42px "Microsoft YaHei", sans-serif';
            ctx.textAlign = 'center';
            ctx.fillText('ä»Šæ—¥è¿åŠ¿', 300, 80);

            // æ˜Ÿåº§
            ctx.font = 'bold 56px "Microsoft YaHei", sans-serif';
            ctx.fillText(`${currentFortune.emoji} ${currentFortune.zodiac}`, 300, 160);

            // æ˜µç§°
            ctx.font = '24px "Microsoft YaHei", sans-serif';
            ctx.fillStyle = 'rgba(255,255,255,0.9)';
            ctx.fillText(currentFortune.nickname, 300, 200);

            // è¿åŠ¿ emoji å’Œè¯„åˆ†
            ctx.font = '80px sans-serif';
            ctx.fillText(currentFortune.fortune.emoji, 300, 300);

            // è¿åŠ¿æ–‡å­—èƒŒæ™¯
            ctx.fillStyle = 'rgba(255,255,255,0.2)';
            roundRect(ctx, 50, 330, 500, 120, 20);
            ctx.fill();

            // è¿åŠ¿è§£è¯»
            ctx.fillStyle = '#ffffff';
            ctx.font = '22px "Microsoft YaHei", sans-serif';
            const text = currentFortune.fortune.text;
            const lines = wrapText(ctx, text, 460);
            let y = 360;
            lines.forEach(line => {
                ctx.fillText(line, 300, y);
                y += 32;
            });

            // å¹¸è¿ä¿¡æ¯åŒºåŸŸ
            const infoY = 490;

            // å¹¸è¿æ•°å­—
            ctx.font = 'bold 20px "Microsoft YaHei", sans-serif';
            ctx.fillText('å¹¸è¿æ•°å­—', 150, infoY);
            ctx.font = 'bold 28px "Microsoft YaHei", sans-serif';
            ctx.fillStyle = '#ffffff';
            ctx.fillText(currentFortune.luckyNum.join('  '), 150, infoY + 40);

            // å¹¸è¿æ–¹å‘
            ctx.font = 'bold 20px "Microsoft YaHei", sans-serif';
            ctx.fillText('å¹¸è¿æ–¹å‘', 450, infoY);
            ctx.font = 'bold 28px "Microsoft YaHei", sans-serif';
            ctx.fillText(currentFortune.direction, 450, infoY + 40);

            // å¹¸è¿ç¾é£Ÿ
            ctx.font = 'bold 20px "Microsoft YaHei", sans-serif';
            ctx.fillText('å¹¸è¿ç¾é£Ÿ', 150, infoY + 90);
            ctx.font = 'bold 28px "Microsoft YaHei", sans-serif';
            ctx.fillText(currentFortune.food, 150, infoY + 130);

            // å¹¸è¿é¢œè‰²
            ctx.font = 'bold 20px "Microsoft YaHei", sans-serif';
            ctx.fillText('å¹¸è¿é¢œè‰²', 450, infoY + 90);
            ctx.fillStyle = currentFortune.color;
            ctx.fillRect(430, infoY + 105, 40, 30);
            ctx.fillStyle = '#ffffff';
            ctx.font = 'bold 18px "Microsoft YaHei", sans-serif';
            ctx.fillText(currentFortune.color, 450, infoY + 130);

            // è¯„åˆ†
            ctx.fillStyle = 'rgba(255,255,255,0.3)';
            roundRect(ctx, 150, 680, 300, 60, 30);
            ctx.fill();
            ctx.fillStyle = '#ffffff';
            ctx.font = 'bold 24px "Microsoft YaHei", sans-serif';
            ctx.fillText(`è¿åŠ¿è¯„åˆ†: {currentFortune.fortune.rating}åˆ†`, 300, 720);

            // æ—¥æœŸ
            ctx.font = '16px "Microsoft YaHei", sans-serif';
            ctx.fillStyle = 'rgba(255,255,255,0.7)';
            ctx.fillText(currentFortune.date, 300, 770);

            // æ°´å°
            ctx.font = '14px "Microsoft YaHei", sans-serif';
            ctx.fillText('auto-tools', 300, 790);
        }

        function roundRect(ctx, x, y, width, height, radius) {
            ctx.beginPath();
            ctx.moveTo(x + radius, y);
            ctx.lineTo(x + width - radius, y);
            ctx.quadraticCurveTo(x + width, y, x + width, y + radius);
            ctx.lineTo(x + width, y + height - radius);
            ctx.quadraticCurveTo(x + width, y + height, x + width - radius, y + height);
            ctx.lineTo(x + radius, y + height);
            ctx.quadraticCurveTo(x, y + height, x, y + height - radius);
            ctx.lineTo(x, y + radius);
            ctx.quadraticCurveTo(x, y, x + radius, y);
            ctx.closePath();
        }

        function wrapText(ctx, text, maxWidth) {
            const lines = [];
            let currentLine = '';

            for (let i = 0; i < text.length; i++) {
                const char = text[i];
                const testLine = currentLine + char;
                const metrics = ctx.measureText(testLine);

                if (metrics.width > maxWidth && currentLine !== '') {
                    lines.push(currentLine);
                    currentLine = char;
                } else {
                    currentLine = testLine;
                }
            }

            if (currentLine) lines.push(currentLine);
            return lines;
        }

        function shadeColor(color, percent) {
            const num = parseInt(color.replace('#', ''), 16);
            const amt = Math.round(2.55 * percent);
            const R = (num >> 16) + amt;
            const G = (num >> 8 & 0x00FF) + amt;
            const B = (num & 0x0000FF) + amt;
            return '#' + (0x1000000 + (R < 255 ? R < 1 ? 0 : R : 255) * 0x10000 +
                (G < 255 ? G < 1 ? 0 : G : 255) * 0x100 +
                (B < 255 ? B < 1 ? 0 : B : 255)).toString(16).slice(1);
        }

        function downloadCard() {
            const canvas = document.getElementById('fortuneCanvas');
            const link = document.createElement('a');
            link.download = `ä»Šæ—¥è¿åŠ¿_${currentFortune.zodiac}_${Date.now()}.png`;
            link.href = canvas.toDataURL('image/png');
            link.click();
        }

        async function copyToClipboard() {
            const canvas = document.getElementById('fortuneCanvas');
            try {
                const blob = await new Promise(resolve => canvas.toBlob(resolve, 'image/png'));
                await navigator.clipboard.write([
                    new ClipboardItem({ 'image/png': blob })
                ]);
                alert('å·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼');
            } catch (err) {
                alert('å¤åˆ¶å¤±è´¥ï¼Œè¯·é•¿æŒ‰å›¾ç‰‡ä¿å­˜');
            }
        }
    </script>
</body>
</html>
