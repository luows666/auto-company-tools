<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æƒ…äººèŠ‚å¡ç‰‡ç”Ÿæˆå™¨ - Auto Tools</title>
    <meta name="description" content="ç”Ÿæˆä¸“å±æƒ…äººèŠ‚å¡ç‰‡ï¼Œé€ç»™æœ€çˆ±çš„TA">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #ff4757;
            --secondary: #ff6b81;
            --pink: #ffeaa7;
            --gradient-1: linear-gradient(135deg, #ff4757, #ff6b81);
            --gradient-2: linear-gradient(135deg, #a55eea, #8854d0);
            --gradient-3: linear-gradient(135deg, #26de81, #20bf6b);
            --gradient-4: linear-gradient(135deg, #fed330, #f79f1f);
            --gradient-5: linear-gradient(135deg, #45aaf2, #2d98da);
            --gradient-6: linear-gradient(135deg, #fd79a8, #e84393);
            --gradient-7: linear-gradient(135deg, #00b894, #00cec9);
            --gradient-8: linear-gradient(135deg, #6c5ce7, #a29bfe);
        }
        body {
            min-height: 100vh;
            background: linear-gradient(135deg, #ffeaa7 0%, #ff6b81 100%);
            font-family: 'PingFang SC', 'Microsoft YaHei', sans-serif;
        }
        .container {
            max-width: 800px;
            padding: 20px;
        }
        .card {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        .card-header {
            background: var(--gradient-1);
            color: white;
            padding: 30px;
            text-align: center;
        }
        .card-header h1 {
            margin: 0;
            font-size: 1.8rem;
        }
        .card-header .heart-icon {
            font-size: 3rem;
            animation: heartbeat 1.5s ease-in-out infinite;
        }
        @keyframes heartbeat {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }
        .card-body {
            padding: 30px;
        }
        .form-label {
            font-weight: 600;
            color: #333;
            margin-bottom: 8px;
        }
        .form-control, .form-select {
            border-radius: 12px;
            padding: 12px 16px;
            border: 2px solid #eee;
            transition: all 0.3s;
        }
        .form-control:focus, .form-select:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(255, 71, 87, 0.1);
        }
        .btn-primary {
            background: var(--gradient-1);
            border: none;
            padding: 14px 32px;
            border-radius: 12px;
            font-weight: 600;
            font-size: 1.1rem;
            transition: all 0.3s;
        }
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(255, 71, 87, 0.3);
        }
        .style-options {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
            margin-top: 10px;
        }
        .style-option {
            height: 60px;
            border-radius: 12px;
            cursor: pointer;
            border: 3px solid transparent;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
            color: white;
            font-weight: 600;
        }
        .style-option:hover {
            transform: scale(1.05);
        }
        .style-option.active {
            border-color: #333;
            transform: scale(1.05);
        }
        .style-1 { background: var(--gradient-1); }
        .style-2 { background: var(--gradient-2); }
        .style-3 { background: var(--gradient-3); }
        .style-4 { background: var(--gradient-4); }
        .style-5 { background: var(--gradient-5); }
        .style-6 { background: var(--gradient-6); }
        .style-7 { background: var(--gradient-7); }
        .style-8 { background: var(--gradient-8); }

        #result {
            margin-top: 30px;
            display: none;
        }
        .preview-card {
            border-radius: 20px;
            padding: 40px;
            color: white;
            text-align: center;
            position: relative;
            overflow: hidden;
            min-height: 400px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }
        .preview-card::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.2) 0%, transparent 60%);
            animation: shine 3s infinite;
        }
        @keyframes shine {
            0%, 100% { transform: translate(-30%, -30%); }
            50% { transform: translate(30%, 30%); }
        }
        .preview-card h2 {
            font-size: 2.2rem;
            margin-bottom: 15px;
            position: relative;
            z-index: 1;
        }
        .preview-card .sender {
            font-size: 1.4rem;
            margin-bottom: 20px;
            position: relative;
            z-index: 1;
        }
        .preview-card .message {
            font-size: 1.3rem;
            line-height: 1.8;
            max-width: 80%;
            position: relative;
            z-index: 1;
        }
        .preview-card .hearts {
            font-size: 3rem;
            margin: 20px 0;
            position: relative;
            z-index: 1;
        }
        .preview-card .date {
            font-size: 1rem;
            opacity: 0.9;
            margin-top: 20px;
            position: relative;
            z-index: 1;
        }
        .action-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 25px;
            flex-wrap: wrap;
        }
        .btn-action {
            padding: 12px 28px;
            border-radius: 12px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s;
        }
        .btn-download { background: #26de81; color: white; }
        .btn-copy { background: #45aaf2; color: white; }
        .btn-action:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        .toast {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 9999;
        }
        .history-section {
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid #eee;
        }
        .history-item {
            background: #f8f9fa;
            border-radius: 12px;
            padding: 15px;
            margin-bottom: 10px;
            cursor: pointer;
            transition: all 0.3s;
        }
        .history-item:hover {
            background: #ffeaa7;
            transform: translateX(5px);
        }
        .tab-buttons {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }
        .tab-btn {
            padding: 10px 20px;
            border: none;
            background: #eee;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
        }
        .tab-btn.active {
            background: var(--primary);
            color: white;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="card">
            <div class="card-header">
                <div class="heart-icon">ğŸ’•</div>
                <h1>æƒ…äººèŠ‚å¡ç‰‡ç”Ÿæˆå™¨</h1>
                <p class="mb-0 mt-2">ç”Ÿæˆä¸“å±æƒ…äººèŠ‚å¡ç‰‡ï¼Œé€ç»™æœ€çˆ±çš„TA</p>
            </div>
            <div class="card-body">
                <div class="tab-buttons">
                    <button class="tab-btn active" onclick="switchTab('create')">åˆ›å»ºå¡ç‰‡</button>
                    <button class="tab-btn" onclick="switchTab('history')">å†å²è®°å½•</button>
                </div>

                <div id="create-tab">
                    <div class="mb-4">
                        <label class="form-label">ä½ çš„åå­—</label>
                        <input type="text" class="form-control" id="senderName" placeholder="è¾“å…¥ä½ çš„åå­—">
                    </div>
                    <div class="mb-4">
                        <label class="form-label">TAçš„åå­—</label>
                        <input type="text" class="form-control" id="receiverName" placeholder="è¾“å…¥TAçš„åå­—">
                    </div>
                    <div class="mb-4">
                        <label class="form-label">é€‰æ‹©å¡ç‰‡é£æ ¼</label>
                        <div class="style-options">
                            <div class="style-option style-1 active" data-style="1" onclick="selectStyle(1)">æµªæ¼«çº¢</div>
                            <div class="style-option style-2" data-style="2" onclick="selectStyle(2)">ç”œèœœç´«</div>
                            <div class="style-option style-3" data-style="3" onclick="selectStyle(3)">æ¸…æ–°ç»¿</div>
                            <div class="style-option style-4" data-style="4" onclick="selectStyle(4)">æš–é˜³é»„</div>
                            <div class="style-option style-5" data-style="5" onclick="selectStyle(5)">æµ·æ´‹è“</div>
                            <div class="style-option style-6" data-style="6" onclick="selectStyle(6)">ç«ç²‰</div>
                            <div class="style-option style-7" data-style="7" onclick="selectStyle(7)">è–„è·</div>
                            <div class="style-option style-8" data-style="8" onclick="selectStyle(8)">æ¢¦å¹»</div>
                        </div>
                    </div>
                    <div class="mb-4">
                        <label class="form-label">æƒ³å¯¹TAè¯´çš„è¯</label>
                        <textarea class="form-control" id="loveMessage" rows="4" placeholder="å†™ä¸‹ä½ æƒ³å¯¹TAè¯´çš„è¯..."></textarea>
                    </div>
                    <button class="btn btn-primary w-100" onclick="generateCard()">
                        <i class="fas fa-heart"></i> ç”Ÿæˆæƒ…äººèŠ‚å¡ç‰‡
                    </button>
                </div>

                <div id="history-tab" style="display: none;">
                    <div id="history-list"></div>
                </div>

                <div id="result">
                    <div class="preview-card" id="previewCard">
                        <h2 id="cardTitle">æƒ…äººèŠ‚å¿«ä¹</h2>
                        <div class="sender" id="cardSender"></div>
                        <div class="hearts">ğŸ’• ğŸ’— ğŸ’–</div>
                        <div class="message" id="cardMessage"></div>
                        <div class="date" id="cardDate"></div>
                    </div>
                    <div class="action-buttons">
                        <button class="btn btn-action btn-download" onclick="downloadCard()">
                            <i class="fas fa-download"></i> ä¸‹è½½å›¾ç‰‡
                        </button>
                        <button class="btn btn-action btn-copy" onclick="copyToClipboard()">
                            <i class="fas fa-copy"></i> å¤åˆ¶åˆ°å‰ªè´´æ¿
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="toast-container">
        <div class="toast" id="toast">
            <div class="toast-body bg-success text-white">
                <i class="fas fa-check-circle"></i> <span id="toastMessage">æ“ä½œæˆåŠŸ</span>
            </div>
        </div>
    </div>

    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    <script>
        let currentStyle = 1;
        let currentCard = null;

        const styleGradients = [
            'linear-gradient(135deg, #ff4757, #ff6b81)',
            'linear-gradient(135deg, #a55eea, #8854d0)',
            'linear-gradient(135deg, #26de81, #20bf6b)',
            'linear-gradient(135deg, #fed330, #f79f1f)',
            'linear-gradient(135deg, #45aaf2, #2d98da)',
            'linear-gradient(135deg, #fd79a8, #e84393)',
            'linear-gradient(135deg, #00b894, #00cec9)',
            'linear-gradient(135deg, #6c5ce7, #a29bfe)'
        ];

        const defaultMessages = [
            "é‡è§ä½ ï¼Œæ˜¯æˆ‘è¿™è¾ˆå­æœ€ç¾ä¸½çš„æ„å¤–ã€‚",
            "åªè¦æœ‰ä½ åœ¨èº«è¾¹ï¼Œæ¯ä¸€å¤©éƒ½æ˜¯æƒ…äººèŠ‚ã€‚",
            "æˆ‘çˆ±ä½ ï¼Œä¸åªæ˜¯ä»Šå¤©ï¼Œè€Œæ˜¯foreverã€‚",
            "ä½ æ˜¯æˆ‘çš„ä¾‹å¤–ï¼Œä¹Ÿæ˜¯æˆ‘çš„åçˆ±ã€‚",
            "å’Œä½ åœ¨ä¸€èµ·çš„æ¯ä¸€å¤©ï¼Œéƒ½å€¼å¾—æ”¶è—ã€‚",
            "ä½ æ˜¯æˆ‘å¿ƒä¸­æœ€ç¾çš„è¯—ï¼Œå†™ä¸å°½çš„æ¸©æŸ”ã€‚",
            "æ˜Ÿæ²³ä¸‡é¡·ï¼Œä½ æ˜¯å”¯ä¸€çš„é£æ™¯ã€‚",
            "ä½™ç”Ÿè¯·å¤šæŒ‡æ•™ï¼Œæˆ‘çš„çˆ±äººã€‚"
        ];

        function selectStyle(style) {
            currentStyle = style;
            document.querySelectorAll('.style-option').forEach(opt => {
                opt.classList.remove('active');
            });
            document.querySelector(`[data-style="${style}"]`).classList.add('active');
        }

        function switchTab(tab) {
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');

            if (tab === 'create') {
                document.getElementById('create-tab').style.display = 'block';
                document.getElementById('history-tab').style.display = 'none';
            } else {
                document.getElementById('create-tab').style.display = 'none';
                document.getElementById('history-tab').style.display = 'block';
                loadHistory();
            }
        }

        function generateCard() {
            const sender = document.getElementById('senderName').value.trim() || 'æˆ‘';
            const receiver = document.getElementById('receiverName').value.trim() || 'TA';
            let message = document.getElementById('loveMessage').value.trim();

            if (!message) {
                message = defaultMessages[Math.floor(Math.random() * defaultMessages.length)];
            }

            const card = {
                sender,
                receiver,
                message,
                style: currentStyle,
                date: new Date().toLocaleDateString('zh-CN')
            };

            currentCard = card;

            // æ›´æ–°é¢„è§ˆ
            document.getElementById('cardTitle').textContent = `${receiver}ï¼Œæƒ…äººèŠ‚å¿«ä¹`;
            document.getElementById('cardSender').textContent = `â€”â€” çˆ±ä½ çš„ ${sender}`;
            document.getElementById('cardMessage').textContent = message;
            document.getElementById('cardDate').textContent = card.date;

            const previewCard = document.getElementById('previewCard');
            previewCard.style.background = styleGradients[currentStyle - 1];

            document.getElementById('result').style.display = 'block';

            // ä¿å­˜åˆ°å†å²
            saveToHistory(card);

            // è¿½è¸ªå·¥å…·ä½¿ç”¨
            trackToolUse('valentine-card');
        }

        function saveToHistory(card) {
            let history = JSON.parse(localStorage.getItem('valentineCardHistory') || '[]');
            history.unshift(card);
            if (history.length > 10) history = history.slice(0, 10);
            localStorage.setItem('valentineCardHistory', JSON.stringify(history));
        }

        function loadHistory() {
            const history = JSON.parse(localStorage.getItem('valentineCardHistory') || '[]');
            const container = document.getElementById('history-list');

            if (history.length === 0) {
                container.innerHTML = '<div class="text-center text-muted py-5">æš‚æ— å†å²è®°å½•</div>';
                return;
            }

            container.innerHTML = history.map((card, index) => `
                <div class="history-item" onclick="loadCard(${index})">
                    <div class="d-flex justify-content-between align-items-center">
                        <div>
                            <strong>${card.sender}</strong> â†’ <strong>${card.receiver}</strong>
                        </div>
                        <small class="text-muted">${card.date}</small>
                    </div>
                    <div class="text-muted small mt-1" style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">
                        ${card.message}
                    </div>
                </div>
            `).join('');
        }

        function loadCard(index) {
            const history = JSON.parse(localStorage.getItem('valentineCardHistory') || '[]');
            const card = history[index];
            if (!card) return;

            currentCard = card;
            currentStyle = card.style || 1;

            document.getElementById('cardTitle').textContent = `${card.receiver}ï¼Œæƒ…äººèŠ‚å¿«ä¹`;
            document.getElementById('cardSender').textContent = `â€”â€” çˆ±ä½ çš„ ${card.sender}`;
            document.getElementById('cardMessage').textContent = card.message;
            document.getElementById('cardDate').textContent = card.date;

            const previewCard = document.getElementById('previewCard');
            previewCard.style.background = styleGradients[currentStyle - 1];

            document.querySelectorAll('.style-option').forEach(opt => {
                opt.classList.remove('active');
            });
            document.querySelector(`[data-style="${currentStyle}"]`).classList.add('active');

            document.getElementById('result').style.display = 'block';
            document.getElementById('create-tab').style.display = 'block';
            document.getElementById('history-tab').style.display = 'none';
            document.querySelectorAll('.tab-btn')[0].classList.add('active');
            document.querySelectorAll('.tab-btn')[1].classList.remove('active');
        }

        async function downloadCard() {
            const card = document.getElementById('previewCard');
            showToast('æ­£åœ¨ç”Ÿæˆå›¾ç‰‡...');

            try {
                const canvas = await html2canvas(card, {
                    scale: 2,
                    backgroundColor: null,
                    useCORS: true
                });

                const link = document.createElement('a');
                link.download = `æƒ…äººèŠ‚å¡ç‰‡_${Date.now()}.png`;
                link.href = canvas.toDataURL('image/png');
                link.click();

                showToast('å›¾ç‰‡ä¸‹è½½æˆåŠŸï¼');
            } catch (e) {
                showToast('ä¸‹è½½å¤±è´¥ï¼Œè¯·é‡è¯•');
            }
        }

        async function copyToClipboard() {
            const card = document.getElementById('previewCard');
            showToast('æ­£åœ¨å¤åˆ¶...');

            try {
                const canvas = await html2canvas(card, {
                    scale: 2,
                    backgroundColor: null,
                    useCORS: true
                });

                canvas.toBlob(async (blob) => {
                    try {
                        await navigator.clipboard.write([
                            new ClipboardItem({ 'image/png': blob })
                        ]);
                        showToast('å·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼');
                    } catch (e) {
                        // å¤‡ç”¨æ–¹æ¡ˆ
                        const item = new ClipboardItem({ 'image/png': blob });
                        await navigator.clipboard.write([item]);
                        showToast('å·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼');
                    }
                });
            } catch (e) {
                // å°è¯•ç›´æ¥å¤åˆ¶æ–‡æœ¬
                const text = `${document.getElementById('cardTitle').textContent}\n${document.getElementById('cardSender').textContent}\n\n${document.getElementById('cardMessage').textContent}\n\nâ€”â€” æ¥è‡ªæƒ…äººèŠ‚å¡ç‰‡ç”Ÿæˆå™¨`;
                await navigator.clipboard.writeText(text);
                showToast('æ–‡æ¡ˆå·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼');
            }
        }

        function trackToolUse(toolName) {
            const tools = JSON.parse(localStorage.getItem('toolsUsed') || '{}');
            tools[toolName] = (tools[toolName] || 0) + 1;
            localStorage.setItem('toolsUsed', JSON.stringify(tools));

            // æ›´æ–°çƒ­é—¨å·¥å…·
            const toolNames = {
                'valentine-card': 'æƒ…äººèŠ‚å¡ç‰‡'
            };
        }

        function showToast(message) {
            const toast = document.getElementById('toast');
            document.getElementById('toastMessage').textContent = message;
            toast.classList.add('show');
            setTimeout(() => toast.classList.remove('show'), 3000);
        }

        // é¡µé¢åŠ è½½æ—¶æ£€æŸ¥æ—¥æœŸ
        window.onload = function() {
            const today = new Date();
            const month = today.getMonth() + 1;
            const day = today.getDate();

            // æƒ…äººèŠ‚æœŸé—´ (2æœˆ) æ˜¾ç¤ºç‰¹åˆ«æç¤º
            if (month === 2) {
                console.log('æƒ…äººèŠ‚å­£èŠ‚åˆ°äº†ï¼');
            }
        };
    </script>
</body>
</html>
