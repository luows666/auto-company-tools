<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åˆåŒæ–‡æ¡£ç”Ÿæˆå™¨ - Auto Tools</title>
    <meta name="description" content="å…è´¹åœ¨çº¿åˆåŒç”Ÿæˆå™¨ - ç”ŸæˆæœåŠ¡åˆåŒã€ç§ŸèµåˆåŒã€æŠ¥ä»·å•ã€æ”¶æ®ç­‰æ–‡æ¡£ï¼Œæ”¯æŒæ‰“å°å’Œå¯¼å‡º">
    <meta name="keywords" content="åˆåŒç”Ÿæˆå™¨,æŠ¥ä»·å•,æ”¶æ®,æ–‡æ¡£æ¨¡æ¿,å…è´¹åˆåŒ">
    <meta property="og:title" content="åˆåŒæ–‡æ¡£ç”Ÿæˆå™¨">
    <meta property="og:description" content="å…è´¹ç”ŸæˆæœåŠ¡åˆåŒã€æŠ¥ä»·å•ã€æ”¶æ®">
    <meta property="og:type" content="website">
    <style>
        :root {
            --primary: #6366f1;
            --primary-dark: #4f46e5;
            --bg: #f8fafc;
            --card: #ffffff;
            --text: #1e293b;
            --text-light: #64748b;
            --success: #10b981;
            --border: #e2e8f0;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--bg);
            color: var(--text);
            min-height: 100vh;
            padding-bottom: 80px;
        }

        header {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            color: white;
            padding: 20px;
            padding-top: 40px;
            border-radius: 0 0 24px 24px;
            box-shadow: 0 4px 20px rgba(99, 102, 241, 0.3);
        }

        header h1 {
            font-size: 1.5rem;
            margin-bottom: 4px;
        }

        header p {
            opacity: 0.9;
            font-size: 0.875rem;
        }

        .back-link {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            color: white;
            text-decoration: none;
            font-size: 0.875rem;
            margin-bottom: 16px;
            opacity: 0.9;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }

        .card {
            background: var(--card);
            border-radius: 16px;
            padding: 24px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }

        h2 {
            font-size: 1.25rem;
            margin-bottom: 16px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .doc-type-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
            margin-bottom: 20px;
        }

        .doc-type-btn {
            padding: 16px;
            border: 2px solid var(--border);
            border-radius: 12px;
            background: white;
            cursor: pointer;
            text-align: left;
            transition: all 0.2s;
        }

        .doc-type-btn:hover {
            border-color: var(--primary);
        }

        .doc-type-btn.active {
            border-color: var(--primary);
            background: #eef2ff;
        }

        .doc-type-btn .icon {
            font-size: 1.5rem;
            display: block;
            margin-bottom: 8px;
        }

        .doc-type-btn .title {
            font-weight: 600;
            margin-bottom: 4px;
        }

        .doc-type-btn .desc {
            font-size: 0.75rem;
            color: var(--text-light);
        }

        .form-group {
            margin-bottom: 16px;
        }

        .form-group label {
            display: block;
            font-size: 0.875rem;
            font-weight: 500;
            margin-bottom: 6px;
        }

        input, textarea, select {
            width: 100%;
            padding: 12px;
            border: 1px solid var(--border);
            border-radius: 8px;
            font-size: 1rem;
            font-family: inherit;
        }

        input:focus, textarea:focus, select:focus {
            outline: none;
            border-color: var(--primary);
        }

        textarea {
            min-height: 100px;
            resize: vertical;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
        }

        .btn-primary {
            background: var(--primary);
            color: white;
            width: 100%;
        }

        .btn-primary:hover {
            background: var(--primary-dark);
        }

        .btn-secondary {
            background: #f1f5f9;
            color: var(--text);
        }

        .btn-success {
            background: var(--success);
            color: white;
        }

        .btn-group {
            display: flex;
            gap: 12px;
            margin-top: 20px;
        }

        .btn-group .btn {
            flex: 1;
        }

        /* Preview */
        .preview-section {
            display: none;
        }

        .preview-section.active {
            display: block;
        }

        .doc-preview {
            background: white;
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 32px;
            min-height: 400px;
            font-family: 'SimSun', 'Songti SC', serif;
            line-height: 1.8;
        }

        .doc-preview h3 {
            text-align: center;
            font-size: 1.25rem;
            margin-bottom: 24px;
            font-weight: bold;
        }

        .doc-preview .doc-info {
            margin-bottom: 20px;
            font-size: 0.9rem;
        }

        .doc-preview .doc-info p {
            margin-bottom: 8px;
        }

        .doc-preview .label {
            display: inline-block;
            min-width: 80px;
            color: var(--text-light);
        }

        .doc-preview .content {
            margin-bottom: 20px;
            text-align: justify;
        }

        .doc-preview .signature {
            margin-top: 48px;
            display: flex;
            justify-content: space-between;
        }

        .doc-preview .signature-item {
            text-align: center;
            width: 45%;
        }

        .doc-preview .signature-line {
            margin-top: 48px;
            border-top: 1px solid #333;
            padding-top: 8px;
        }

        /* Tabs */
        .tabs {
            display: flex;
            gap: 8px;
            margin-bottom: 20px;
            overflow-x: auto;
        }

        .tab {
            padding: 10px 16px;
            border: none;
            background: #f1f5f9;
            color: var(--text-light);
            border-radius: 8px;
            font-size: 0.875rem;
            cursor: pointer;
            white-space: nowrap;
        }

        .tab.active {
            background: var(--primary);
            color: white;
        }

        /* Saved Docs */
        .saved-list {
            display: grid;
            gap: 12px;
        }

        .saved-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 16px;
            background: #f8fafc;
            border-radius: 8px;
        }

        .saved-item .info .type {
            font-weight: 600;
            margin-bottom: 4px;
        }

        .saved-item .info .date {
            font-size: 0.75rem;
            color: var(--text-light);
        }

        .saved-item .actions {
            display: flex;
            gap: 8px;
        }

        .saved-item .btn {
            padding: 8px 12px;
            font-size: 0.875rem;
        }

        .empty-state {
            text-align: center;
            padding: 40px;
            color: var(--text-light);
        }

        /* Footer */
        footer {
            text-align: center;
            padding: 20px;
            color: var(--text-light);
            font-size: 0.75rem;
        }

        footer a {
            color: var(--primary);
            text-decoration: none;
        }
    </style>
</head>
<body>
    <header>
        <a href="index.html" class="back-link">â† è¿”å›å·¥å…·é¦–é¡µ</a>
        <h1>ğŸ“ åˆåŒæ–‡æ¡£ç”Ÿæˆå™¨</h1>
        <p>å…è´¹ç”ŸæˆæœåŠ¡åˆåŒã€æŠ¥ä»·å•ã€æ”¶æ®</p>
    </header>

    <div class="container">
        <div class="tabs">
            <button class="tab active" data-tab="create">æ–°å»ºæ–‡æ¡£</button>
            <button class="tab" data-tab="saved">å·²ä¿å­˜</button>
        </div>

        <!-- Create Tab -->
        <div class="tab-content" id="create">
            <div class="card">
                <h2>é€‰æ‹©æ–‡æ¡£ç±»å‹</h2>
                <div class="doc-type-grid">
                    <button class="doc-type-btn active" data-type="service">
                        <span class="icon">ğŸ“„</span>
                        <div class="title">æœåŠ¡åˆåŒ</div>
                        <div class="desc">æä¾›æœåŠ¡çš„åŒæ–¹åè®®</div>
                    </button>
                    <button class="doc-type-btn" data-type="rental">
                        <span class="icon">ğŸ </span>
                        <div class="title">ç§ŸèµåˆåŒ</div>
                        <div class="desc">æˆ¿å±‹æˆ–è®¾å¤‡ç§Ÿèµåè®®</div>
                    </button>
                    <button class="doc-type-btn" data-type="quote">
                        <span class="icon">ğŸ’°</span>
                        <div class="title">æŠ¥ä»·å•</div>
                        <div class="desc">äº§å“æˆ–æœåŠ¡æŠ¥ä»·</div>
                    </button>
                    <button class="doc-type-btn" data-type="receipt">
                        <span class="icon">ğŸ§¾</span>
                        <div class="title">æ”¶æ®</div>
                        <div class="desc">æ”¶æ¬¾å‡­è¯</div>
                    </button>
                </div>
            </div>

            <div class="card" id="formSection">
                <!-- Dynamic form will be inserted here -->
            </div>

            <div class="card preview-section" id="previewSection">
                <h2>ğŸ“‹ æ–‡æ¡£é¢„è§ˆ</h2>
                <div class="doc-preview" id="docPreview"></div>
                <div class="btn-group">
                    <button class="btn btn-primary" onclick="printDoc()">æ‰“å° / å¯¼å‡º PDF</button>
                    <button class="btn btn-success" onclick="saveDoc()">ä¿å­˜</button>
                </div>
            </div>
        </div>

        <!-- Saved Tab -->
        <div class="tab-content" id="saved" style="display: none;">
            <div class="card">
                <h2>ğŸ’¾ å·²ä¿å­˜çš„æ–‡æ¡£</h2>
                <div class="saved-list" id="savedList">
                    <div class="empty-state">æš‚æ— ä¿å­˜çš„æ–‡æ¡£</div>
                </div>
            </div>
        </div>
    </div>

    <footer>
        <a href="index.html">è¿”å›é¦–é¡µ</a> |
        <a href="mailto:feedback@autocompany.dev">åé¦ˆ</a>
    </footer>

    <script>
        // State
        let currentType = 'service';
        let formData = {};

        // Form Templates
        const forms = {
            service: `
                <h2>ğŸ“ æœåŠ¡åˆåŒä¿¡æ¯</h2>
                <div class="form-row">
                    <div class="form-group">
                        <label>ç”²æ–¹ï¼ˆå§”æ‰˜æ–¹ï¼‰</label>
                        <input type="text" id="partyA" placeholder="å…¬å¸åç§°æˆ–ä¸ªäººå§“å">
                    </div>
                    <div class="form-group">
                        <label>ä¹™æ–¹ï¼ˆæœåŠ¡æ–¹ï¼‰</label>
                        <input type="text" id="partyB" placeholder="å…¬å¸åç§°æˆ–ä¸ªäººå§“å">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>ç­¾è®¢æ—¥æœŸ</label>
                        <input type="date" id="signDate">
                    </div>
                    <div class="form-group">
                        <label>æœåŠ¡æœŸé™</label>
                        <input type="text" id="servicePeriod" placeholder="å¦‚ï¼š1å¹´/6ä¸ªæœˆ">
                    </div>
                </div>
                <div class="form-group">
                    <label>æœåŠ¡å†…å®¹</label>
                    <textarea id="serviceContent" placeholder="è¯¦ç»†æè¿°æœåŠ¡å†…å®¹..."></textarea>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>æœåŠ¡è´¹ç”¨ï¼ˆå…ƒï¼‰</label>
                        <input type="number" id="serviceFee" placeholder="é‡‘é¢">
                    </div>
                    <div class="form-group">
                        <label>ä»˜æ¬¾æ–¹å¼</label>
                        <select id="paymentMethod">
                            <option value="ä¸€æ¬¡æ€§æ”¯ä»˜">ä¸€æ¬¡æ€§æ”¯ä»˜</option>
                            <option value="æœˆä»˜">æ¯æœˆæ”¯ä»˜</option>
                            <option value="å­£ä»˜">æ¯å­£æ”¯ä»˜</option>
                            <option value="å®Œæˆåæ”¯ä»˜">å®Œæˆåæ”¯ä»˜</option>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label>å…¶ä»–æ¡æ¬¾</label>
                    <textarea id="otherTerms" placeholder="å…¶ä»–çº¦å®šæ¡æ¬¾ï¼ˆå¯é€‰ï¼‰..."></textarea>
                </div>
                <button class="btn btn-primary" onclick="generateDoc()">ç”Ÿæˆé¢„è§ˆ</button>
            `,
            rental: `
                <h2>ğŸ  ç§ŸèµåˆåŒä¿¡æ¯</h2>
                <div class="form-row">
                    <div class="form-group">
                        <label>ç”²æ–¹ï¼ˆå‡ºç§Ÿæ–¹ï¼‰</label>
                        <input type="text" id="partyA" placeholder="æˆ¿ä¸œå§“åæˆ–å…¬å¸">
                    </div>
                    <div class="form-group">
                        <label>ä¹™æ–¹ï¼ˆæ‰¿ç§Ÿæ–¹ï¼‰</label>
                        <input type="text" id="partyB" placeholder="ç§Ÿå®¢å§“åæˆ–å…¬å¸">
                    </div>
                </div>
                <div class="form-group">
                    <label>ç§Ÿèµç‰©å“/æˆ¿å±‹</label>
                    <input type="text" id="rentalItem" placeholder="å¦‚ï¼šXXè·¯XXå·æˆ¿å±‹/è®¾å¤‡åç§°">
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>ç§Ÿèµå¼€å§‹æ—¥æœŸ</label>
                        <input type="date" id="startDate">
                    </div>
                    <div class="form-group">
                        <label>ç§Ÿèµç»“æŸæ—¥æœŸ</label>
                        <input type="date" id="endDate">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>æœˆç§Ÿé‡‘ï¼ˆå…ƒï¼‰</label>
                        <input type="number" id="monthlyRent" placeholder="ç§Ÿé‡‘é‡‘é¢">
                    </div>
                    <div class="form-group">
                        <label>æŠ¼é‡‘ï¼ˆå…ƒï¼‰</label>
                        <input type="number" id="deposit" placeholder="æŠ¼é‡‘é‡‘é¢">
                    </div>
                </div>
                <div class="form-group">
                    <label>ä»˜æ¬¾æ–¹å¼</label>
                    <select id="paymentMethod">
                        <option value="æœˆä»˜">æ¯æœˆä»˜</option>
                        <option value="å­£ä»˜">æ¯å­£ä»˜</option>
                        <option value="åŠå¹´ä»˜">æ¯åŠå¹´ä»˜</option>
                        <option value="å¹´ä»˜">æ¯å¹´ä»˜</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>å…¶ä»–æ¡æ¬¾</label>
                    <textarea id="otherTerms" placeholder="å…¶ä»–çº¦å®šæ¡æ¬¾ï¼ˆå¯é€‰ï¼‰..."></textarea>
                </div>
                <button class="btn btn-primary" onclick="generateDoc()">ç”Ÿæˆé¢„è§ˆ</button>
            `,
            quote: `
                <h2>ğŸ’° æŠ¥ä»·å•ä¿¡æ¯</h2>
                <div class="form-row">
                    <div class="form-group">
                        <label>æŠ¥ä»·æ–¹</label>
                        <input type="text" id="fromParty" placeholder="æ‚¨çš„å…¬å¸/å§“å">
                    </div>
                    <div class="form-group">
                        <label>æŠ¥ä»·æ—¥æœŸ</label>
                        <input type="date" id="quoteDate">
                    </div>
                </div>
                <div class="form-group">
                    <label>å®¢æˆ·åç§°</label>
                    <input type="text" id="toParty" placeholder="å®¢æˆ·å…¬å¸/å§“å">
                </div>
                <div class="form-group">
                    <label>äº§å“/æœåŠ¡æ˜ç»†</label>
                    <textarea id="items" placeholder="äº§å“1: å•ä»· x æ•°é‡&#10;äº§å“2: å•ä»· x æ•°é‡&#10;..."></textarea>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>åˆè®¡é‡‘é¢ï¼ˆå…ƒï¼‰</label>
                        <input type="number" id="totalAmount" placeholder="æ€»é‡‘é¢">
                    </div>
                    <div class="form-group">
                        <label>æœ‰æ•ˆæœŸ</label>
                        <input type="text" id="validPeriod" placeholder="å¦‚ï¼š30å¤©">
                    </div>
                </div>
                <div class="form-group">
                    <label>å¤‡æ³¨</label>
                    <textarea id="remarks" placeholder="å…¶ä»–è¯´æ˜ï¼ˆå¯é€‰ï¼‰..."></textarea>
                </div>
                <button class="btn btn-primary" onclick="generateDoc()">ç”Ÿæˆé¢„è§ˆ</button>
            `,
            receipt: `
                <h2>ğŸ§¾ æ”¶æ®ä¿¡æ¯</h2>
                <div class="form-row">
                    <div class="form-group">
                        <label>æ”¶æ¬¾æ–¹</label>
                        <input type="text" id="fromParty" placeholder="æ‚¨çš„å…¬å¸/å§“å">
                    </div>
                    <div class="form-group">
                        <label>ä»˜æ¬¾æ–¹</label>
                        <input type="text" id="toParty" placeholder="å®¢æˆ·å…¬å¸/å§“å">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>æ”¶æ¬¾æ—¥æœŸ</label>
                        <input type="date" id="receiptDate">
                    </div>
                    <div class="form-group">
                        <label>æ”¶æ®ç¼–å·</label>
                        <input type="text" id="receiptNo" placeholder="å¯é€‰">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>æ”¶æ¬¾é‡‘é¢ï¼ˆå…ƒï¼‰</label>
                        <input type="number" id="amount" placeholder="é‡‘é¢">
                    </div>
                    <div class="form-group">
                        <label>æ”¶æ¬¾æ–¹å¼</label>
                        <select id="paymentMethod">
                            <option value="ç°é‡‘">ç°é‡‘</option>
                            <option value="é“¶è¡Œè½¬è´¦">é“¶è¡Œè½¬è´¦</option>
                            <option value="æ”¯ä»˜å®">æ”¯ä»˜å®</option>
                            <option value="å¾®ä¿¡æ”¯ä»˜">å¾®ä¿¡æ”¯ä»˜</option>
                            <option value="å…¶ä»–">å…¶ä»–</option>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label>æ”¶æ¬¾äº‹ç”±</label>
                    <input type="text" id="reason" placeholder="å¦‚ï¼šæœåŠ¡è´¹/è´§æ¬¾/ç§Ÿé‡‘">
                </div>
                <button class="btn btn-primary" onclick="generateDoc()">ç”Ÿæˆé¢„è§ˆ</button>
            `
        };

        // Doc Templates
        const templates = {
            service: (d) => `
                <h3>æœåŠ¡åˆåŒ</h3>
                <div class="doc-info">
                    <p><span class="label">ç­¾è®¢æ—¥æœŸï¼š</span>${d.signDate || '_________'}</p>
                    <p><span class="label">ç”²æ–¹ï¼š</span>${d.partyA || '_________'}</p>
                    <p><span class="label">ä¹™æ–¹ï¼š</span>${d.partyB || '_________'}</p>
                </div>
                <div class="content">
                    <p>ç”²ä¹™åŒæ–¹æœ¬ç€å¹³ç­‰è‡ªæ„¿çš„åŸåˆ™ï¼Œå°±ç”²æ–¹å§”æ‰˜ä¹™æ–¹æä¾›æœåŠ¡äº‹å®œè¾¾æˆå¦‚ä¸‹åè®®ï¼š</p>
                    <p><strong>ç¬¬ä¸€æ¡ æœåŠ¡å†…å®¹</strong></p>
                    <p>${d.serviceContent || '____________________________'}</p>
                    <p><strong>ç¬¬äºŒæ¡ æœåŠ¡æœŸé™</strong></p>
                    <p>æœåŠ¡æœŸé™ï¼š${d.servicePeriod || '________'}</p>
                    <p><strong>ç¬¬ä¸‰æ¡ æœåŠ¡è´¹ç”¨</strong></p>
                    <p>æœåŠ¡è´¹ç”¨æ€»é¢ä¸ºäººæ°‘å¸ï¼ˆå¤§å†™ï¼‰ï¼š${toChinese(d.serviceFee || 0)} å…ƒæ•´ï¼ˆÂ¥${d.serviceFee || 0}ï¼‰</p>
                    <p>ä»˜æ¬¾æ–¹å¼ï¼š${d.paymentMethod || '________'}</p>
                    ${d.otherTerms ? `<p><strong>ç¬¬å››æ¡ å…¶ä»–çº¦å®š</strong></p><p>${d.otherTerms}</p>` : ''}
                </div>
                <div class="signature">
                    <div class="signature-item">
                        <p>ç”²æ–¹ï¼ˆç›–ç« ï¼‰ï¼š</p>
                        <div class="signature-line"></div>
                        <p>æ—¥æœŸï¼š</p>
                    </div>
                    <div class="signature-item">
                        <p>ä¹™æ–¹ï¼ˆç›–ç« ï¼‰ï¼š</p>
                        <div class="signature-line"></div>
                        <p>æ—¥æœŸï¼š</p>
                    </div>
                </div>
            `,
            rental: (d) => `
                <h3>ç§ŸèµåˆåŒ</h3>
                <div class="doc-info">
                    <p><span class="label">ç­¾è®¢æ—¥æœŸï¼š</span>${d.startDate || '_________'}</p>
                    <p><span class="label">ç”²æ–¹ï¼š</span>${d.partyA || '_________'}</p>
                    <p><span class="label">ä¹™æ–¹ï¼š</span>${d.partyB || '_________'}</p>
                </div>
                <div class="content">
                    <p>ç”²ä¹™åŒæ–¹æœ¬ç€å¹³ç­‰è‡ªæ„¿çš„åŸåˆ™ï¼Œå°±ç”²æ–¹å°†${d.rentalItem || '____________'}å‡ºç§Ÿç»™ä¹™æ–¹ä½¿ç”¨äº‹å®œè¾¾æˆå¦‚ä¸‹åè®®ï¼š</p>
                    <p><strong>ç¬¬ä¸€æ¡ ç§ŸèµæœŸé™</strong></p>
                    <p>ç§ŸèµæœŸé™ï¼šè‡ª ${d.startDate || '____å¹´__æœˆ__æ—¥'} è‡³ ${d.endDate || '____å¹´__æœˆ__æ—¥'}</p>
                    <p><strong>ç¬¬äºŒæ¡ ç§Ÿé‡‘åŠæŠ¼é‡‘</strong></p>
                    <p>æœˆç§Ÿé‡‘ï¼šäººæ°‘å¸ï¼ˆå¤§å†™ï¼‰ï¼š${toChinese(d.monthlyRent || 0)} å…ƒæ•´ï¼ˆÂ¥${d.monthlyRent || 0}ï¼‰</p>
                    <p>æŠ¼é‡‘ï¼šäººæ°‘å¸ï¼ˆå¤§å†™ï¼‰ï¼š${toChinese(d.deposit || 0)} å…ƒæ•´ï¼ˆÂ¥${d.deposit || 0}ï¼‰</p>
                    <p>ä»˜æ¬¾æ–¹å¼ï¼š${d.paymentMethod || '________'}</p>
                    ${d.otherTerms ? `<p><strong>ç¬¬ä¸‰æ¡ å…¶ä»–çº¦å®š</strong></p><p>${d.otherTerms}</p>` : ''}
                </div>
                <div class="signature">
                    <div class="signature-item">
                        <p>ç”²æ–¹ï¼ˆç­¾å­—ï¼‰ï¼š</p>
                        <div class="signature-line"></div>
                        <p>æ—¥æœŸï¼š</p>
                    </div>
                    <div class="signature-item">
                        <p>ä¹™æ–¹ï¼ˆç­¾å­—ï¼‰ï¼š</p>
                        <div class="signature-line"></div>
                        <p>æ—¥æœŸï¼š</p>
                    </div>
                </div>
            `,
            quote: (d) => `
                <h3>æŠ¥ä»·å•</h3>
                <div class="doc-info">
                    <p><span class="label">æŠ¥ä»·æ—¥æœŸï¼š</span>${d.quoteDate || '_________'}</p>
                    <p><span class="label">æŠ¥ä»·æ–¹ï¼š</span>${d.fromParty || '_________'}</p>
                    <p><span class="label">å®¢æˆ·ï¼š</span>${d.toParty || '_________'}</p>
                </div>
                <div class="content">
                    <p><strong>æŠ¥ä»·æ˜ç»†ï¼š</strong></p>
                    <p style="white-space: pre-line;">${d.items || '____________________________'}</p>
                    <p><strong>åˆè®¡é‡‘é¢ï¼š</strong>äººæ°‘å¸ï¼ˆå¤§å†™ï¼‰ï¼š${toChinese(d.totalAmount || 0)} å…ƒæ•´ï¼ˆÂ¥${d.totalAmount || 0}ï¼‰</p>
                    <p><strong>æœ‰æ•ˆæœŸï¼š</strong>${d.validPeriod || '________'}</p>
                    ${d.remarks ? `<p><strong>å¤‡æ³¨ï¼š</strong>${d.remarks}</p>` : ''}
                </div>
                <div class="signature">
                    <div class="signature-item">
                        <p>æŠ¥ä»·æ–¹ï¼ˆç›–ç« ï¼‰ï¼š</p>
                        <div class="signature-line"></div>
                        <p>æ—¥æœŸï¼š</p>
                    </div>
                    <div class="signature-item">
                        <p>å®¢æˆ·ç¡®è®¤ï¼š</p>
                        <div class="signature-line"></div>
                        <p>æ—¥æœŸï¼š</p>
                    </div>
                </div>
            `,
            receipt: (d) => `
                <h3>æ”¶æ®</h3>
                <div class="doc-info">
                    <p><span class="label">æ—¥æœŸï¼š</span>${d.receiptDate || '_________'}</p>
                    <p><span class="label">ç¼–å·ï¼š</span>${d.receiptNo || '_________'}</p>
                </div>
                <div class="content">
                    <p>ä»Šæ”¶åˆ° <strong>${d.toParty || '_________'}</strong> æ”¯ä»˜çš„æ¬¾é¡¹ï¼Œå…·ä½“å¦‚ä¸‹ï¼š</p>
                    <p><strong>æ”¶æ¬¾é‡‘é¢ï¼š</strong>äººæ°‘å¸ï¼ˆå¤§å†™ï¼‰ï¼š${toChinese(d.amount || 0)} å…ƒæ•´ï¼ˆÂ¥${d.amount || 0}ï¼‰</p>
                    <p><strong>æ”¶æ¬¾æ–¹å¼ï¼š</strong>${d.paymentMethod || '________'}</p>
                    <p><strong>æ”¶æ¬¾äº‹ç”±ï¼š</strong>${d.reason || '________'}</p>
                </div>
                <div class="signature">
                    <div class="signature-item">
                        <p>æ”¶æ¬¾äººï¼š</p>
                        <div class="signature-line"></div>
                        <p>ï¼ˆç­¾å­—/ç›–ç« ï¼‰</p>
                    </div>
                    <div class="signature-item">
                        <p>ä»˜æ¬¾äººï¼š</p>
                        <div class="signature-line"></div>
                        <p>ï¼ˆç­¾å­—ï¼‰</p>
                    </div>
                </div>
            `
        };

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            // Set default date
            document.getElementById('signDate')?.setAttribute('value', new Date().toISOString().split('T')[0]);
            document.getElementById('startDate')?.setAttribute('value', new Date().toISOString().split('T')[0]);
            document.getElementById('quoteDate')?.setAttribute('value', new Date().toISOString().split('T')[0]);
            document.getElementById('receiptDate')?.setAttribute('value', new Date().toISOString().split('T')[0]);

            renderForm();
            loadSavedDocs();
        });

        // Tab switching
        document.querySelectorAll('.tab').forEach(tab => {
            tab.addEventListener('click', () => {
                document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                document.querySelectorAll('.tab-content').forEach(c => c.style.display = 'none');
                tab.classList.add('active');
                document.getElementById(tab.dataset.tab).style.display = 'block';
            });
        });

        // Doc type selection
        document.querySelectorAll('.doc-type-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                document.querySelectorAll('.doc-type-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                currentType = btn.dataset.type;
                renderForm();
            });
        });

        function renderForm() {
            const formSection = document.getElementById('formSection');
            formSection.innerHTML = forms[currentType];
            document.getElementById('previewSection').classList.remove('active');

            // Set default dates for new form
            const today = new Date().toISOString().split('T')[0];
            const dateInputs = formSection.querySelectorAll('input[type="date"]');
            dateInputs.forEach(input => {
                if (!input.value) input.value = today;
            });
        }

        function generateDoc() {
            // Collect form data
            const inputs = document.querySelectorAll('#formSection input, #formSection textarea, #formSection select');
            formData = {};
            inputs.forEach(input => {
                formData[input.id] = input.value;
            });
            formData.type = currentType;

            // Generate preview
            const preview = document.getElementById('docPreview');
            preview.innerHTML = templates[currentType](formData);
            document.getElementById('previewSection').classList.add('active');
        }

        function printDoc() {
            const content = document.getElementById('docPreview').innerHTML;
            const printWindow = window.open('', '_blank');
            printWindow.document.write(`
                <!DOCTYPE html>
                <html>
                <head>
                    <title>æ‰“å°æ–‡æ¡£</title>
                    <style>
                        body { font-family: 'SimSun', 'Songti SC', serif; padding: 40px; line-height: 1.8; }
                        h3 { text-align: center; font-size: 18pt; margin-bottom: 24px; }
                        .doc-info { margin-bottom: 20px; }
                        .doc-info p { margin-bottom: 8px; }
                        .label { display: inline-block; min-width: 80px; color: #666; }
                        .content { text-align: justify; margin-bottom: 20px; }
                        .content p { margin-bottom: 12px; }
                        .signature { margin-top: 48px; display: flex; justify-content: space-between; }
                        .signature-item { text-align: center; width: 45%; }
                        .signature-line { margin-top: 48px; border-top: 1px solid #333; padding-top: 8px; }
                        @media print { body { padding: 0; } }
                    </style>
                </head>
                <body>${content}</body>
                </html>
            `);
            printWindow.document.close();
            printWindow.print();
        }

        function saveDoc() {
            const saved = JSON.parse(localStorage.getItem('savedDocs') || '[]');
            formData.savedAt = Date.now();
            formData.id = Date.now();
            saved.unshift(formData);
            localStorage.setItem('savedDocs', JSON.stringify(saved));
            alert('æ–‡æ¡£å·²ä¿å­˜ï¼');
            loadSavedDocs();
        }

        function loadSavedDocs() {
            const saved = JSON.parse(localStorage.getItem('savedDocs') || '[]');
            const list = document.getElementById('savedList');

            if (saved.length === 0) {
                list.innerHTML = '<div class="empty-state">æš‚æ— ä¿å­˜çš„æ–‡æ¡£</div>';
                return;
            }

            const typeNames = {
                service: 'æœåŠ¡åˆåŒ',
                rental: 'ç§ŸèµåˆåŒ',
                quote: 'æŠ¥ä»·å•',
                receipt: 'æ”¶æ®'
            };

            list.innerHTML = saved.map(doc => `
                <div class="saved-item">
                    <div class="info">
                        <div class="type">${typeNames[doc.type] || doc.type}</div>
                        <div class="date">${new Date(doc.savedAt).toLocaleString('zh-CN')}</div>
                    </div>
                    <div class="actions">
                        <button class="btn btn-secondary" onclick="loadDoc(${doc.id})">æŸ¥çœ‹</button>
                        <button class="btn btn-secondary" onclick="deleteDoc(${doc.id})">åˆ é™¤</button>
                    </div>
                </div>
            `).join('');
        }

        function loadDoc(id) {
            const saved = JSON.parse(localStorage.getItem('savedDocs') || '[]');
            const doc = saved.find(d => d.id === id);
            if (!doc) return;

            currentType = doc.type;
            formData = doc;

            // Update UI
            document.querySelectorAll('.doc-type-btn').forEach(b => {
                b.classList.toggle('active', b.dataset.type === currentType);
            });

            // Switch to create tab
            document.querySelector('.tab[data-tab="create"]').click();
            renderForm();

            // Fill form
            Object.keys(doc).forEach(key => {
                const el = document.getElementById(key);
                if (el) el.value = doc[key];
            });

            // Generate preview
            generateDoc();
        }

        function deleteDoc(id) {
            if (!confirm('ç¡®å®šåˆ é™¤æ­¤æ–‡æ¡£ï¼Ÿ')) return;
            let saved = JSON.parse(localStorage.getItem('savedDocs') || '[]');
            saved = saved.filter(d => d.id !== id);
            localStorage.setItem('savedDocs', JSON.stringify(saved));
            loadSavedDocs();
        }

        // Number to Chinese
        function toChinese(num) {
            if (!num) return 'é›¶';
            const digits = ['é›¶', 'å£¹', 'è´°', 'å', 'è‚†', 'ä¼', 'é™†', 'æŸ’', 'æŒ', 'ç–'];
            const units = ['', 'æ‹¾', 'ä½°', 'ä»Ÿ', 'ä¸‡'];

            num = Math.round(num);
            if (num === 0) return 'é›¶';

            let result = '';
            let str = num.toString();
            let len = str.length;

            for (let i = 0; i < len; i++) {
                let n = parseInt(str[i]);
                let unit = len - i - 1;
                if (n !== 0) {
                    result += digits[n] + units[unit];
                } else if (result.length > 0 && result[result.length - 1] !== 'é›¶') {
                    result += 'é›¶';
                }
            }

            result = result.replace(/é›¶+$/, '');
            return result || 'é›¶';
        }
    </script>
</body>
</html>
