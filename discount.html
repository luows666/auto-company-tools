<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>限时优惠计算器 - Auto Tools</title>
    <meta name="description" content="计算折扣、价格优惠、限时促销。支持折扣计算、满减计算、买赠计算等多种优惠方式。">
    <meta name="keywords" content="优惠计算,折扣计算,满减计算,促销工具,限时折扣">
    <meta property="og:title" content="限时优惠计算器">
    <meta property="og:description" content="计算折扣、价格优惠、限时促销">
    <meta property="og:type" content="website">
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "WebApplication",
        "name": "限时优惠计算器",
        "description": "计算折扣、价格优惠、限时促销",
        "url": "https://luows666.github.io/auto-tools/discount.html",
        "applicationCategory": "UtilitiesApplication",
        "offers": {"@type": "Offer", "price": "0", "priceCurrency": "USD"}
    }
    </script>
    <style>
        :root {
            --primary: #6366f1;
            --primary-dark: #4f46e5;
            --bg: #f8fafc;
            --card: #ffffff;
            --text: #1e293b;
            --text-light: #64748b;
            --success: #10b981;
            --error: #ef4444;
            --warning: #f59e0b;
        }
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; background: var(--bg); color: var(--text); min-height: 100vh; padding-bottom: 80px; }
        header { background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%); color: white; padding: 20px; padding-top: 40px; border-radius: 0 0 24px 24px; box-shadow: 0 4px 20px rgba(99, 102, 241, 0.3); }
        header h1 { font-size: 1.5rem; margin-bottom: 4px; }
        header p { opacity: 0.9; font-size: 0.875rem; }
        .back-link { display: inline-flex; align-items: center; gap: 6px; color: white; text-decoration: none; margin-bottom: 16px; font-size: 0.875rem; }
        .content { padding: 16px; max-width: 600px; margin: 0 auto; }
        .card { background: var(--card); border-radius: 16px; padding: 20px; box-shadow: 0 1px 3px rgba(0,0,0,0.1); margin-bottom: 16px; }
        .card h2 { font-size: 1.125rem; margin-bottom: 16px; display: flex; align-items: center; gap: 8px; }
        input, select { width: 100%; padding: 12px; border: 1px solid #e2e8f0; border-radius: 8px; font-size: 1rem; margin-bottom: 12px; }
        input:focus, select:focus { outline: none; border-color: var(--primary); }
        button { padding: 12px 20px; border: none; border-radius: 8px; font-size: 1rem; cursor: pointer; transition: all 0.2s; font-weight: 500; }
        .btn-primary { background: var(--primary); color: white; width: 100%; }
        .btn-primary:hover { background: var(--primary-dark); }
        .result-box { background: linear-gradient(135deg, #dbeafe 0%, #ede9fe 100%); border-radius: 12px; padding: 20px; text-align: center; margin-top: 16px; }
        .result-box .original { font-size: 0.875rem; color: var(--text-light); text-decoration: line-through; }
        .result-box .final { font-size: 2rem; font-weight: 700; color: var(--primary); margin: 8px 0; }
        .result-box .save { color: var(--success); font-weight: 600; }
        .tabs { display: flex; gap: 8px; margin-bottom: 16px; overflow-x: auto; }
        .tab { padding: 10px 16px; border: none; background: #f1f5f9; color: var(--text-light); border-radius: 8px; font-size: 0.875rem; cursor: pointer; white-space: nowrap; transition: all 0.2s; }
        .tab.active { background: var(--primary); color: white; }
        .calc-section { display: none; }
        .calc-section.active { display: block; }
        .helper { font-size: 0.75rem; color: var(--text-light); margin-top: 4px; }
        .history-item { padding: 12px; background: #f8fafc; border-radius: 8px; margin-bottom: 8px; display: flex; justify-content: space-between; align-items: center; }
        .history-item .op { font-weight: 500; }
        .history-item .res { color: var(--primary); font-weight: 600; }
        .sponsor { position: fixed; bottom: 0; left: 0; right: 0; background: var(--card); padding: 12px; text-align: center; border-top: 1px solid #e2e8f0; font-size: 0.75rem; color: var(--text-light); }
        .sponsor a { color: var(--primary); text-decoration: none; }
    </style>
</head>
<body>
    <header>
        <a href="index.html" class="back-link">← 返回工具箱</a>
        <h1>限时优惠计算器</h1>
        <p>计算折扣、满减、买赠等优惠</p>
    </header>

    <div class="content">
        <div class="tabs">
            <button class="tab active" data-target="discount">折扣计算</button>
            <button class="tab" data-target="满减">满减计算</button>
            <button class="tab" data-target="买赠">买赠计算</button>
            <button class="tab" data-target="原价">原价计算</button>
        </div>

        <!-- 折扣计算 -->
        <div id="discount" class="calc-section active">
            <div class="card">
                <h2>折扣计算</h2>
                <label class="helper">原价</label>
                <input type="number" id="disc-price" placeholder="输入商品原价" step="0.01">
                <label class="helper">折扣 (如 8 折输入 80)</label>
                <input type="number" id="disc-rate" placeholder="输入折扣，如 80 表示 8 折" step="0.1">
                <button class="btn-primary" onclick="calcDiscount()">计算</button>
                <div id="disc-result" class="result-box" style="display: none;">
                    <div class="original">原价: ¥<span></span></div>
                    <div class="final">¥<span></span></div>
                    <div class="save">省了 ¥<span></span></div>
                </div>
            </div>
        </div>

        <!-- 满减计算 -->
        <div id="满减" class="calc-section">
            <div class="card">
                <h2>满减计算</h2>
                <label class="helper">订单金额</label>
                <input type="number" id="mj-price" placeholder="输入订单金额" step="0.01">
                <label class="helper">满多少</label>
                <input type="number" id="mj-threshold" placeholder="如 200" step="0.01">
                <label class="helper">减多少</label>
                <input type="number" id="mj-reduce" placeholder="如 20" step="0.01">
                <button class="btn-primary" onclick="calcManjian()">计算</button>
                <div id="mj-result" class="result-box" style="display: none;">
                    <div class="original">订单金额: ¥<span></span></div>
                    <div class="final">¥<span></span></div>
                    <div class="save">省了 ¥<span></span></div>
                </div>
            </div>
        </div>

        <!-- 买赠计算 -->
        <div id="买赠" class="calc-section">
            <div class="card">
                <h2>买赠计算</h2>
                <label class="helper">商品单价</label>
                <input type="number" id="gift-price" placeholder="输入商品单价" step="0.01">
                <label class="helper">买几件</label>
                <input type="number" id="gift-buy" placeholder="如 2" value="2">
                <label class="helper">送几件</label>
                <input type="number" id="gift-get" placeholder="如 1" value="1">
                <button class="btn-primary" onclick="calcGift()">计算</button>
                <div id="gift-result" class="result-box" style="display: none;">
                    <div class="original">原总价: ¥<span></span></div>
                    <div class="final">¥<span></span></div>
                    <div class="save">相当于 <span></span> 折</div>
                </div>
            </div>
        </div>

        <!-- 原价计算 -->
        <div id="原价" class="calc-section">
            <div class="card">
                <h2>原价计算</h2>
                <label class="helper">折后价</label>
                <input type="number" id="orig-final" placeholder="输入支付金额" step="0.01">
                <label class="helper">折扣 (如 8 折输入 80)</label>
                <input type="number" id="orig-rate" placeholder="输入折扣" step="0.1">
                <button class="btn-primary" onclick="calcOriginal()">计算</button>
                <div id="orig-result" class="result-box" style="display: none;">
                    <div class="original">支付金额: ¥<span></span></div>
                    <div class="final">原价: ¥<span></span></div>
                    <div class="save"><span></span> 折</div>
                </div>
            </div>
        </div>

        <!-- 历史记录 -->
        <div class="card">
            <h2>计算历史</h2>
            <div id="history"></div>
            <button class="btn-secondary" style="width: 100%; margin-top: 8px;" onclick="clearHistory()">清空历史</button>
        </div>
    </div>

    <div class="sponsor">
        支持我们: <a href="payment-qr.html" target="_blank">赞助</a> | <a href="feedback@autocompany.dev">反馈</a>
    </div>

    <script>
        // Tab 切换
        document.querySelectorAll('.tab').forEach(tab => {
            tab.addEventListener('click', () => {
                document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                document.querySelectorAll('.calc-section').forEach(s => s.classList.remove('active'));
                tab.classList.add('active');
                document.getElementById(tab.dataset.target).classList.add('active');
            });
        });

        // 折扣计算
        function calcDiscount() {
            const price = parseFloat(document.getElementById('disc-price').value);
            const rate = parseFloat(document.getElementById('disc-rate').value);
            if (!price || !rate) return alert('请输入原价和折扣');
            const final = price * rate / 100;
            const save = price - final;
            showResult('disc-result', price, final, save);
            addHistory(`折扣 ${rate}%`, price, final);
        }

        // 满减计算
        function calcManjian() {
            const price = parseFloat(document.getElementById('mj-price').value);
            const threshold = parseFloat(document.getElementById('mj-threshold').value);
            const reduce = parseFloat(document.getElementById('mj-reduce').value);
            if (!price || !threshold || !reduce) return alert('请输入完整信息');
            let final = price;
            if (price >= threshold) final = price - reduce;
            const save = price - final;
            showResult('mj-result', price, final, save);
            addHistory(`满${threshold}减${reduce}`, price, final);
        }

        // 买赠计算
        function calcGift() {
            const price = parseFloat(document.getElementById('gift-price').value);
            const buy = parseInt(document.getElementById('gift-buy').value);
            const get = parseInt(document.getElementById('gift-get').value);
            if (!price || !buy || !get) return alert('请输入完整信息');
            const total = buy + get;
            const originalTotal = price * total;
            const actualPay = price * buy;
            const rate = (actualPay / originalTotal * 100).toFixed(1);
            showResult('gift-result', originalTotal, actualPay, null, rate);
            addHistory(`买${buy}送${get}`, originalTotal, actualPay);
        }

        // 原价计算
        function calcOriginal() {
            const final = parseFloat(document.getElementById('orig-final').value);
            const rate = parseFloat(document.getElementById('orig-rate').value);
            if (!final || !rate) return alert('请输入完整信息');
            const original = final / (rate / 100);
            showResult('orig-result', final, original, null, rate);
            addHistory(`原价${rate}%`, final, original);
        }

        function showResult(id, original, final, save, rate) {
            const el = document.getElementById(id);
            el.style.display = 'block';
            el.querySelectorAll('.original span')[0].textContent = original.toFixed(2);
            el.querySelectorAll('.final span')[0].textContent = final.toFixed(2);
            if (save !== null) {
                el.querySelectorAll('.save span')[0].textContent = save.toFixed(2);
            } else if (rate !== null) {
                el.querySelectorAll('.save span')[0].textContent = rate;
            }
        }

        function addHistory(op, original, final) {
            const history = JSON.parse(localStorage.getItem('discount_history') || '[]');
            history.unshift({ op, original, final, time: new Date().toLocaleTimeString() });
            if (history.length > 10) history.pop();
            localStorage.setItem('discount_history', JSON.stringify(history));
            renderHistory();
        }

        function renderHistory() {
            const history = JSON.parse(localStorage.getItem('discount_history') || '[]');
            const el = document.getElementById('history');
            if (history.length === 0) {
                el.innerHTML = '<p style="color: var(--text-light); text-align: center;">暂无历史记录</p>';
                return;
            }
            el.innerHTML = history.map(h => `
                <div class="history-item">
                    <span class="op">${h.op}</span>
                    <span>¥${h.original.toFixed(2)} → ¥${h.final.toFixed(2)}</span>
                </div>
            `).join('');
        }

        function clearHistory() {
            localStorage.removeItem('discount_history');
            renderHistory();
        }

        renderHistory();
    </script>
</body>
</html>
